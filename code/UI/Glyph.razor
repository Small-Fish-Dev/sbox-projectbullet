@using System
@using Sandbox
@using Sandbox.UI
@namespace ProjectBullet.UI.HUD
@inherits Sandbox.UI.Panel;

@code {
    private Image Image { get; set; }
    private InputGlyphSize ButtonSize { get; set; } = InputGlyphSize.Medium;
    private InputButton Button { get; set; } = 0;
    public bool HasButton => Button != 0;

    public override void SetProperty(string name, string value)
    {
        base.SetProperty(name, value);

        switch (name)
        {
            case "input":
                try
                {
                    Button = Enum.Parse<InputButton>(value, true);
                }
                catch (ArgumentException)
                {
                    if (ulong.TryParse(value, out var number))
                    {
                        Button = (InputButton)number;
                    }
                    else
                    {
                        throw new ArgumentException($"Couldn't find input glyph for {value}");
                    }
                }
                break;
            case "size":
                ButtonSize = Enum.Parse<InputGlyphSize>(value, true);
                break;
        }
    }

    public override void Tick()
    {
        base.Tick();

        if (!HasButton)
        {
            return;
        }

        Image.Texture = Input.GetGlyph(Button, ButtonSize, GlyphStyle.Knockout);
        Image.Style.Height = Image.ComputedStyle != null ? Image.ComputedStyle.FontSize ?? Image.Texture.Height : Image.Texture.Height;
        Image.Style.AspectRatio = (float)Image.Texture.Width / Image.Texture.Height;
    }

}

<root>
    <image style="align-items: center; justify-content: center;" @ref="Image"/>
</root>